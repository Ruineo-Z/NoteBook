## 编曲提示词工作清单（按步骤执行）

> 说明：本清单用于 Skill 执行，不是角色台词。必须先建任务再执行。

### 任务层（先执行）

1. 创建父任务：`{song} 编曲提示词任务`
2. 创建 7 个子任务（P1-P7）
3. 任务规则见：`task-protocol.md`

---

### 步骤1：启动检查（P1）

1. 确认歌词阶段已完成。
2. 检查输入文件是否齐全：
   - `{song}-analysis.md`
   - `{song}-lyrics.txt`
3. 说明本阶段只生成编曲提示词，不改歌词内容。

---

### 步骤2：输入解析（P2）

从分析报告提取：
- BPM / 时长
- 段落顺序与功能
- 风格线索（如抒情、叙事、爆发段）

从歌词提取：
- 段落结构标签
- 情绪推进路径（铺垫 -> 累积 -> 爆发 -> 转折 -> 收束）

---

### 步骤3：编曲策略设计（P3）

依据 `producer-methodology.md` 确定：
- 风格与速度描述
- 主奏与伴奏层次
- 人声音色与演唱策略
- 段落能量曲线

要求：先给出策略，再生成最终提示词。

---

### 步骤4：英文版 Suno Prompt 生成（P4）

按 `suno-prompt-spec.md` 输出：

```text
[Suno Prompt]

[Style]
...

[Lead]
...

[Backing]
...

[Vocals]
...

[Structure]
...
```

要求：
- 使用自然英文短语
- 避免中文和 Markdown
- `[Suno Prompt]` 区块总字符 <= 1000

---

### 步骤5：中文版解释稿生成（P5）

与英文版一一对应输出：
- `[风格]`
- `[主奏]`
- `[伴奏]`
- `[人声]`
- `[结构]`

要求：
- 只做解释，不改变英文版核心语义
- 便于用户理解与修改

---

### 步骤6：质量门禁与格式校验（P6）

1. 先做格式硬校验：

```bash
node skills/ziqi-producer/scripts/validate_arrangement_prompt.js --file /abs/path/{song}-arrangement-draft.txt
```

2. 再对照 `quality-gates.md` 做语义门禁。
3. 任一项不通过，回到 P3/P4/P5 修订。

---

### 步骤7：用户确认与文件保存（P7）

1. 展示英中双版本，询问“请确认编曲提示词是否满意？”
2. 用户确认后保存为 `{song}-arrangement.txt`
3. 给出完成说明与文件位置
4. 标记父任务完成
